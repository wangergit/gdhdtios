{"version":3,"sources":["webpack:///./src/common/js/cordova/camera.js","webpack:///./src/views/dynamic/issue.vue?2c2f","webpack:///src/views/dynamic/issue.vue","webpack:///./src/views/dynamic/issue.vue?dd49","webpack:///./src/views/dynamic/issue.vue"],"names":["savePicture","resolve","reject","window","ImagePicker","getPictures","result","maxCount","defaultList","MediaPicker","getMedias","options","getBase64","item","extractThumbnail"],"mappings":"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","file":"static/js/22.js","sourcesContent":["export function savePicture() {\n    return new Promise((resolve, reject) => {\n        if (window.ImagePicker && typeof window.ImagePicker.getPictures === 'function') {\n            return reject('无法打开相册')\n        }\n\n        window.ImagePicker.getPictures(result => {\n            resolve(JSON.stringify(result))\n        }, reject)\n    })\n}\n\nexport function getPictures(maxCount = 9, defaultList = null) {\n    return new Promise((resolve, reject) => {\n        if (!window.MediaPicker || typeof window.MediaPicker.getMedias !== 'function') {\n            return reject('无法打开相册')\n        }\n\n        const options = {\n            'selectMode': 100, //101=picker image and video , 100=image , 102=video\n            'maxSelectCount': maxCount, //default 40 (Optional)\n            'maxSelectSize': 10485760, //10485760=10M (Optional)\n            'defaultSelectedList': defaultList\n        }\n\n        window.MediaPicker.getMedias(options, resolve, reject)\n    })\n}\n\nexport function getBase64(item) {\n    return new Promise((resolve, reject) => {\n        if (!window.MediaPicker || typeof window.MediaPicker.extractThumbnail !== 'function') {\n            return reject('没有找到转换文件方法')\n        }\n\n        window.MediaPicker.extractThumbnail(item, resolve, reject)\n    })\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/common/js/cordova/camera.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/extract-text-webpack-plugin/dist/loader.js?{\"omit\":1,\"remove\":true}!./node_modules/vue-style-loader!./node_modules/css-loader?{\"sourceMap\":true}!./node_modules/vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-28912f41\",\"scoped\":true,\"hasInlineConfig\":false}!./node_modules/stylus-loader?{\"sourceMap\":true}!./node_modules/vue-loader/lib/selector.js?type=styles&index=0!./src/views/dynamic/issue.vue\n// module id = gbqE\n// module chunks = 22","<template>\n    <div class=\"dynamic-issue\">\n        <mu-appbar class=\"appbar\" title=\"发布动态\">\n            <mu-button slot=\"left\" color=\"#fff\" @click=\"$router.back()\" icon>\n                <mu-icon value=\"navigate_before\"/>\n            </mu-button>\n            <mu-button slot=\"right\" color=\"#fff\" @click=\"handlerSubmit\" flat>\n                发布\n            </mu-button>\n        </mu-appbar>\n        <!-- 动态发布 -->\n        <div class=\"dynamic-issue-content scroll-wrapper\">\n            <!-- 输入框 -->\n            <div class=\"input-wrapper border-1px-b\">\n                <mu-text-field v-model=\"content\" placeholder=\"分享新鲜事 ...\"\n                               :rows=\"5\"\n                               :rows-max=\"8\"\n                               multi-line\n                               full-width\n                               solo/>\n            </div>\n            <!-- 输入框 -->\n            <!-- 图片上传 -->\n            <div class=\"picture-wrapper\">\n                <div class=\"picture\" v-for=\"(item, index) in images\" :key=\"index\"\n                     @click=\"handlerBrowse(index)\"\n                     :style=\"`background-image: url(${item})`\">\n                    <mu-button color=\"#f44336\" @click.stop=\"onDeletePicture(item, index)\" small icon>\n                        <mu-icon value=\"delete\"/>\n                    </mu-button>\n                </div>\n                <mu-ripple class=\"picture border-1px\" @click=\"handlerPicture\" v-if=\"images.length < 9\">\n                    <mu-icon class=\"append\" value=\"add\" size=\"50\"/>\n                </mu-ripple>\n            </div>\n            <!-- 图片上传 -->\n            <!--<div class=\"location-wrapper\">-->\n            <!--<div class=\"location\">-->\n            <!--<mu-icon value=\"location_on\" size=\"15\"/>-->\n            <!--<span class=\"text\">武汉段. 汉口水道口水道口水道口水道口水道口水道口水道口水道口水道口水道口水道口水道口水道口水道口水道口水道口水道口水道口水道口水道</span>-->\n            <!--</div>-->\n            <!--</div>-->\n        </div>\n        <!-- 动态发布 -->\n    </div>\n</template>\n\n<script>\n    import Navigate from \"../../base/navigate/navigate\"\n    import {saveMoment} from \"../../api/dynamic\"\n    import ImagePreview from \"vant/lib/image-preview\"\n    import {uploadBase64} from \"../../api/sys\"\n    import {isArray} from \"../../types/index\"\n    import {getPictures, getBase64} from \"../../common/js/cordova/camera\"\n\n    export default {\n        name: \"dynamicIssue\",\n        data() {\n            return {\n                content: \"\",\n                images: [],\n                defaultList: []\n            }\n        },\n        activated() {\n            this.content = ''\n            this.defaultList = []\n            this.images = []\n        },\n        methods: {\n            /***\n             * 点击选择图片\n             */\n            handlerPicture() {\n                // this.$refs.file.click()\n                getPictures(9, this.defaultList).then(images => {\n                    this.images = []\n                    this.defaultList = []\n\n                    Array.prototype.map.call(images, item => {\n                        this.defaultList.push(item.path)\n\n                        getBase64(item).then(res => {\n                            this.images.push(`data:image/jpeg;base64,${res.thumbnailBase64}`)\n                        })\n                    })\n                })\n            },\n            /***\n             * 提交\n             */\n            async handlerSubmit() {\n                const loading = this.$loading()\n\n                const data = {\n                    content: this.content,\n                    type: '004001',\n                    mediaType: '003002',\n                    status: '020002'\n                }\n\n                if (this.images.length) {\n                    const images = await Promise.all(this.images.map(item => {\n                        // return upload(item.file)\n                        return uploadBase64(item)\n                    }))\n\n                    data.mediaPath = isArray(images).join(';')\n                }\n\n                await saveMoment(data)\n\n                loading.close()\n\n                this.$toast('发表成功！')\n\n                this.$emit('refresh')\n\n                this.$router.go(-2)\n            },\n            /***\n             * 点击浏览图片\n             */\n            handlerBrowse(index) {\n                ImagePreview({\n                    images: this.images,\n                    startPosition: index\n                })\n            },\n            /***\n             * 点击删除图片\n             */\n            onDeletePicture(item, index) {\n                this.images.splice(index, 1)\n\n                this.defaultList.splice(index, 1)\n            }\n        },\n        components: {\n            Navigate\n        }\n    };\n</script>\n\n<style lang=\"stylus\" scoped>\n    @import '../../common/stylus/variable.styl'\n    @import \"../../common/stylus/mixins.styl\"\n\n    .dynamic-issue\n        padding-top 46px\n        background-color #fff\n        overflow hidden\n        .appbar\n            position absolute\n            top 0\n            left 0\n            z-index 1\n            width 100%\n            height 46px\n            box-shadow none\n            background-color #3899D7\n        >>> .mu-appbar-title\n            display flex\n            align-items center\n            justify-content center\n            line-height 46px\n            color #fff\n            font-size 15px\n        .scroll-wrapper\n            width 100%\n            height 100%\n            .input-wrapper\n                padding 10px 15px\n            .location-wrapper\n                position relative\n                padding 0 15px\n                height 26px\n                .location\n                    position absolute\n                    display flex\n                    align-items center\n                    padding 0 15px\n                    max-width 80%\n                    height 26px\n                    font-size $font-size-sm\n                    background-color #efefef\n                    border-radius 16px\n                    overflow hidden\n                    .text\n                        flex 1\n                        no-wrap()\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/views/dynamic/issue.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"dynamic-issue\"},[_c('mu-appbar',{staticClass:\"appbar\",attrs:{\"title\":\"发布动态\"}},[_c('mu-button',{attrs:{\"slot\":\"left\",\"color\":\"#fff\",\"icon\":\"\"},on:{\"click\":function($event){_vm.$router.back()}},slot:\"left\"},[_c('mu-icon',{attrs:{\"value\":\"navigate_before\"}})],1),_vm._v(\" \"),_c('mu-button',{attrs:{\"slot\":\"right\",\"color\":\"#fff\",\"flat\":\"\"},on:{\"click\":_vm.handlerSubmit},slot:\"right\"},[_vm._v(\"\\n            发布\\n        \")])],1),_vm._v(\" \"),_c('div',{staticClass:\"dynamic-issue-content scroll-wrapper\"},[_c('div',{staticClass:\"input-wrapper border-1px-b\"},[_c('mu-text-field',{attrs:{\"placeholder\":\"分享新鲜事 ...\",\"rows\":5,\"rows-max\":8,\"multi-line\":\"\",\"full-width\":\"\",\"solo\":\"\"},model:{value:(_vm.content),callback:function ($$v) {_vm.content=$$v},expression:\"content\"}})],1),_vm._v(\" \"),_c('div',{staticClass:\"picture-wrapper\"},[_vm._l((_vm.images),function(item,index){return _c('div',{key:index,staticClass:\"picture\",style:((\"background-image: url(\" + item + \")\")),on:{\"click\":function($event){_vm.handlerBrowse(index)}}},[_c('mu-button',{attrs:{\"color\":\"#f44336\",\"small\":\"\",\"icon\":\"\"},on:{\"click\":function($event){$event.stopPropagation();_vm.onDeletePicture(item, index)}}},[_c('mu-icon',{attrs:{\"value\":\"delete\"}})],1)],1)}),_vm._v(\" \"),(_vm.images.length < 9)?_c('mu-ripple',{staticClass:\"picture border-1px\",on:{\"click\":_vm.handlerPicture}},[_c('mu-icon',{staticClass:\"append\",attrs:{\"value\":\"add\",\"size\":\"50\"}})],1):_vm._e()],2)])],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-28912f41\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/dynamic/issue.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-28912f41\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./issue.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./issue.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./issue.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-28912f41\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./issue.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-28912f41\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/dynamic/issue.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}