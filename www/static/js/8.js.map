{"version":3,"sources":["webpack:///src/views/about/message/chat.vue","webpack:///./src/views/about/message/chat.vue?ce42","webpack:///./src/views/about/message/chat.vue","webpack:///./src/views/about/message/chat.vue?9deb"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmCA;AACA;AACA;;AAEA;AACA,gBADA;AAEA,QAFA,kBAEA;AACA;AACA,uBADA;AAEA,gDAFA;AAGA,oBAHA;AAIA,uBAJA;AAKA;AACA,4BADA;AAEA,gCAFA;AAGA,4BAHA;AAIA;AAJA,aALA;AAWA;AAXA;AAaA,KAhBA;;AAiBA;AACA;AACA,wBADA;AAEA;AAFA;AADA,KAjBA;AAuBA;AACA,mBADA,yBACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AAjBA,KAvBA;AA0CA,WA1CA,qBA0CA;AACA;AACA;AACA;AACA;AACA;AACA,KAhDA;AAiDA,WAjDA,qBAiDA;AACA;AACA,KAnDA;AAoDA,iBApDA,2BAoDA;AACA;AACA,KAtDA;;AAuDA;AACA,eADA,mBACA,KADA,EACA;AACA;AACA;AACA,SAJA;AAKA,qBALA,2BAKA;AACA;AACA;AACA;;AAEA;AACA,6CADA;AAEA,4BAFA;AAGA,qCAHA;AAIA,yBAJA;AAKA;AALA;;AAQA;;AAEA;AACA,SArBA;;AAsBA;AACA,2BAvBA,iCAuBA;AAAA;;AACA;AACA;AACA,aAFA,EAEA,EAFA;AAGA,SA3BA;AA4BA,2BA5BA,iCA4BA;AAAA;;AACA,YAAY,gDAAZ;AACA;AACA,aAFA,EAEA,KAFA,CAEA;AACA;AACA,aAJA;AAKA,SAlCA;AAmCA,qBAnCA,2BAmCA;AACA;AACA;AACA;AACA,aAFA;AAGA,SAxCA;AAyCA,cAzCA,kBAyCA,OAzCA,EAyCA;AACA;AACA;AA3CA,KAvDA;AAoGA;AACA;AADA,KApGA;AAuGA;AACA;AADA,KAvGA;AA0GA;AACA,YADA,kBACA;AACA;AACA;AAHA;AA1GA,G;;ACvCA,0BAA0B,aAAa,0BAA0B,wBAAwB,iBAAiB,mBAAmB,iBAAiB,OAAO,sCAAsC,wBAAwB,4DAA4D,YAAY,kBAAkB,0CAA0C,kBAAkB,mBAAmB,mFAAmF,2BAA2B,yBAAyB,OAAO,oBAAoB,oCAAoC,iBAAiB,0EAA0E,kBAAkB,OAAO,aAAa,YAAY,OAAO,mCAAmC,KAAK,qBAAqB,0BAA0B,8BAA8B,UAAU,sBAAsB,uCAAuC,QAAQ,8BAA8B,oCAAoC,aAAa,wCAAwC,qBAAqB,EAAE,KAAK,4BAA4B,cAAc,wBAAwB,cAAc,aAAa,wEAAwE,SAAS,cAAc,WAAW,sBAAsB,KAAK,yBAAyB,4BAA4B,QAAQ,EAAE,kCAAkC,gCAAgC,4BAA4B,yBAAyB,KAAK,2BAA2B;AACr+C;AACA,iBAAiB;AACF,0D;;ACHf;AACA,EAAE,mBAAO,CAAC,MAAyZ;AACna;AACA,yBAAyB,mBAAO,CAAC,MAA+D;AAChG;AAC8G;AACa;AAC3H;AACoX;AACpX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,IAAc;AAChB,EAAE,YAAgB;AAClB;AACA;AACA;AACA;AACA;;AAEe,yGAAiB;;;;;;;;AC1BhC,yC","file":"static/js/8.js","sourcesContent":["<template>\r\n    <div class=\"chat\">\r\n        <navigate title=\"广东航道\" position=\"absolute\"/>\r\n        <div class=\"message-list-wrapper\" ref=\"MessageListWrapper\">\r\n            <div ref=\"MessageList\">\r\n                <template v-for=\"list in messageList\">\r\n                    <div class=\"time\">{{list[0].createTime | formatPast}}</div>\r\n                    <div class=\"message-list\">\r\n                        <transition-group name=\"fade-chat\">\r\n                            <div class=\"item\" :class=\"item.self ? 'item-right' : 'item-left'\"\r\n                                 v-for=\"(item, index) in list\" :key=\"index\">\r\n                                <mu-avatar size=\"45\">\r\n                                    <img :src=\"item.avatar\" @error=\"onError\" :alt=\"item.title\">\r\n                                </mu-avatar>\r\n                                <div class=\"content-wrapper\">\r\n                                    <p class=\"content\">{{item.content}}</p>\r\n                                </div>\r\n                            </div>\r\n                        </transition-group>\r\n                    </div>\r\n                </template>\r\n            </div>\r\n        </div>\r\n        <div class=\"message-input-wrapper\">\r\n            <form action=\"javascrpt:;\" class=\"message-input-form\" @submit=\"handlerSubmit\">\r\n                <label class=\"input-box\">\r\n                    <input type=\"text\" v-model=\"message\">\r\n                </label>\r\n                <mu-button class=\"submit\" color=\"#fff\" flat @click=\"handlerSubmit\">发送</mu-button>\r\n            </form>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import Navigate from '../../../base/navigate/navigate'\r\n    import FormatTime from '../../../common/utils/time'\r\n    import {queryIMessageDetail} from \"../../../api/personal\"\r\n\r\n    export default {\r\n        name: \"chat\",\r\n        data() {\r\n            return {\r\n                message: '',\r\n                defaultAvatar: 'static/image/bg.png',\r\n                list: [],\r\n                timer: null,\r\n                queryParam: {\r\n                    userId: null,\r\n                    receiverId: null,\r\n                    pageSize: 10,\r\n                    pageNumber: 0\r\n                },\r\n                webSocket: null\r\n            }\r\n        },\r\n        props: {\r\n            id: {\r\n                type: String,\r\n                default: ''\r\n            }\r\n        },\r\n        computed: {\r\n            messageList() {\r\n                if (this.list.length === 0) {\r\n                    return\r\n                }\r\n                const list = [[this.list[0]]]\r\n                let index = 0\r\n                for (let i = 0; i < this.list.length - 1; i++) {\r\n                    // if (this.list[i].createTime - this.list[i + 1].createTime < 2 * 60 * 1000) {\r\n                    list[index].push(this.list[i + 1])\r\n                    // } else {\r\n                    //     index++\r\n                    //     list[index].push(this.list[i + 1])\r\n                    // }\r\n                }\r\n\r\n                return list.reverse()\r\n            }\r\n        },\r\n        created() {\r\n            this.queryParam.userId = this.$route.query.userId\r\n            this.queryParam.receiverId = this.$route.query.receiverId\r\n            this.queryIMessageDetail()\r\n            // this.initWebsocket()\r\n            console.log(`%c—————— request ${this.id} message ——————`, 'color: #009688')\r\n        },\r\n        mounted() {\r\n            this.handlerScrollHeight()\r\n        },\r\n        beforeDestroy() {\r\n            clearInterval(this.timer)\r\n        },\r\n        methods: {\r\n            onError(event) {\r\n                event.target.setAttribute('data-src', event.target.getAttribute('src'))\r\n                event.target.setAttribute('src', null)\r\n            },\r\n            handlerSubmit() {\r\n                if (!this.message) {\r\n                    return this.$toast('请输入内容')\r\n                }\r\n\r\n                this.list.push({\r\n                    avatar: 'static/image/bg.png',\r\n                    title: '哈哈哈',\r\n                    content: this.message,\r\n                    use: true,\r\n                    time: Date.now()\r\n                })\r\n\r\n                // this.doSend(this.message)\r\n\r\n                this.message = ''\r\n            },\r\n            // 列表再最后\r\n            handlerScrollHeight() {\r\n                setTimeout(time => {\r\n                    this.$refs.MessageListWrapper.scrollTo(0, this.$refs.MessageList.offsetHeight)\r\n                }, 60)\r\n            },\r\n            queryIMessageDetail() {\r\n                queryIMessageDetail(this.queryParam).then(res => {\r\n                    this.list = res\r\n                }).catch(error => {\r\n                    console.log(error)\r\n                })\r\n            },\r\n            initWebsocket() {\r\n                this.websocket = new WebSocket('ws://localhost:8080/websocket?user=1');\r\n                this.websocket.onmessage = evt => {\r\n                    console.log(evt.data)\r\n                }\r\n            },\r\n            doSend(message) {\r\n                this.websocket.send(\"hello\")\r\n            }\r\n        },\r\n        filters: {\r\n            formatPast: FormatTime.formatPast\r\n        },\r\n        components: {\r\n            Navigate\r\n        },\r\n        watch: {\r\n            list() {\r\n                this.handlerScrollHeight()\r\n            }\r\n        }\r\n    }\r\n</script>\r\n\r\n<style lang=\"stylus\" scoped>\r\n    @import \"../../../common/stylus/variable.styl\"\r\n\r\n    .chat\r\n        position absolute\r\n        top 0\r\n        right 0\r\n        left 0\r\n        bottom 0\r\n        z-index 1000\r\n        padding 46px 0 50px\r\n        background-color #EFEFEF\r\n        overflow hidden\r\n        .message-list-wrapper\r\n            width 100%\r\n            height 100%\r\n            overflow-x hidden\r\n            overflow-y auto\r\n            .time\r\n                margin 10px 0\r\n                color #B2B2B2\r\n                text-align center\r\n                font-size $font-size-ms\r\n            .message-list .item\r\n                display flex\r\n                padding 0 12px\r\n                margin-bottom 15px\r\n                .content-wrapper\r\n                    flex 1\r\n                    .content\r\n                        position relative\r\n                        display inline-block\r\n                        padding 10px 15px\r\n                        min-height 44px\r\n                        line-height 1.5625\r\n                        font-size $font-size-ml\r\n                        text-align justify\r\n                        color #696969\r\n                        background-color #fff\r\n                        border-radius 5px\r\n                &.item-left\r\n                    transform-origin left bottom\r\n                    .content-wrapper\r\n                        padding 0 23px 0 10px\r\n                        text-align left\r\n                        &:before\r\n                            content ''\r\n                            display block\r\n                            position absolute\r\n                            top 17.5px\r\n                            left -10px\r\n                            width 0\r\n                            height 0\r\n                            border 5px solid transparent\r\n                            border-right-color #fff\r\n                &.item-right\r\n                    flex-direction row-reverse\r\n                    transform-origin right bottom\r\n                    .content-wrapper\r\n                        padding 0 10px 0 23px\r\n                        text-align right\r\n                        .content:before\r\n                            content ''\r\n                            display block\r\n                            position absolute\r\n                            top 17.5px\r\n                            right -10px\r\n                            width 0\r\n                            height 0\r\n                            border 5px solid transparent\r\n                            border-left-color #fff\r\n        .message-input-wrapper\r\n            position fixed\r\n            bottom 0\r\n            left 0\r\n            right 0\r\n            .message-input-form\r\n                display flex\r\n                align-items center\r\n                height 50px\r\n                padding 0 15px\r\n                background-color #FAFAFA\r\n                .input-box\r\n                    flex 1\r\n                    margin-right 10px\r\n                    > input\r\n                        width 100%\r\n                        height 32px\r\n                        line-height 32px\r\n                        border 1px solid #EEEEEE\r\n                        outline none\r\n                        text-indent .5em\r\n                .submit\r\n                    min-width 60px\r\n                    height 30px\r\n                    line-height 30px\r\n                    background-color #3899D7\r\n                    >>> .mu-button-wrapper\r\n                        padding 0\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/views/about/message/chat.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"chat\"},[_c('navigate',{attrs:{\"title\":\"广东航道\",\"position\":\"absolute\"}}),_vm._v(\" \"),_c('div',{ref:\"MessageListWrapper\",staticClass:\"message-list-wrapper\"},[_c('div',{ref:\"MessageList\"},[_vm._l((_vm.messageList),function(list){return [_c('div',{staticClass:\"time\"},[_vm._v(_vm._s(_vm._f(\"formatPast\")(list[0].createTime)))]),_vm._v(\" \"),_c('div',{staticClass:\"message-list\"},[_c('transition-group',{attrs:{\"name\":\"fade-chat\"}},_vm._l((list),function(item,index){return _c('div',{key:index,staticClass:\"item\",class:item.self ? 'item-right' : 'item-left'},[_c('mu-avatar',{attrs:{\"size\":\"45\"}},[_c('img',{attrs:{\"src\":item.avatar,\"alt\":item.title},on:{\"error\":_vm.onError}})]),_vm._v(\" \"),_c('div',{staticClass:\"content-wrapper\"},[_c('p',{staticClass:\"content\"},[_vm._v(_vm._s(item.content))])])],1)}))],1)]})],2)]),_vm._v(\" \"),_c('div',{staticClass:\"message-input-wrapper\"},[_c('form',{staticClass:\"message-input-form\",attrs:{\"action\":\"javascrpt:;\"},on:{\"submit\":_vm.handlerSubmit}},[_c('label',{staticClass:\"input-box\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.message),expression:\"message\"}],attrs:{\"type\":\"text\"},domProps:{\"value\":(_vm.message)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.message=$event.target.value}}})]),_vm._v(\" \"),_c('mu-button',{staticClass:\"submit\",attrs:{\"color\":\"#fff\",\"flat\":\"\"},on:{\"click\":_vm.handlerSubmit}},[_vm._v(\"发送\")])],1)])],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-07e3e88e\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/about/message/chat.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-07e3e88e\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./chat.vue\")\n}\nvar normalizeComponent = require(\"!../../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./chat.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./chat.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-07e3e88e\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../node_modules/vue-loader/lib/selector?type=template&index=0!./chat.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-07e3e88e\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/about/message/chat.vue\n// module id = null\n// module chunks = ","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/extract-text-webpack-plugin/dist/loader.js?{\"omit\":1,\"remove\":true}!./node_modules/vue-style-loader!./node_modules/css-loader?{\"sourceMap\":true}!./node_modules/vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-07e3e88e\",\"scoped\":true,\"hasInlineConfig\":false}!./node_modules/stylus-loader?{\"sourceMap\":true}!./node_modules/vue-loader/lib/selector.js?type=styles&index=0!./src/views/about/message/chat.vue\n// module id = eIUs\n// module chunks = 8"],"sourceRoot":""}