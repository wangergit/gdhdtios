{"version":3,"sources":["webpack:///src/views/about/message/chat.vue","webpack:///./src/views/about/message/chat.vue?dfd0","webpack:///./src/views/about/message/chat.vue","webpack:///./src/views/about/message/chat.vue?0506"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmCA;AACA;AACA;;AAEA;AACA,gBADA;AAEA,QAFA,kBAEA;AACA;AACA,uBADA;AAEA,gDAFA;AAGA,oBAHA;AAIA,uBAJA;AAKA;AACA,4BADA;AAEA,gCAFA;AAGA,4BAHA;AAIA;AAJA,aALA;AAWA;AAXA;AAaA,KAhBA;;AAiBA;AACA;AACA,wBADA;AAEA;AAFA;AADA,KAjBA;AAuBA;AACA,mBADA,yBACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AAjBA,KAvBA;AA0CA,WA1CA,qBA0CA;AACA;AACA;AACA;AACA;AACA;AACA,KAhDA;AAiDA,WAjDA,qBAiDA;AACA;AACA,KAnDA;AAoDA,iBApDA,2BAoDA;AACA;AACA,KAtDA;;AAuDA;AACA,eADA,mBACA,KADA,EACA;AACA;AACA;AACA,SAJA;AAKA,qBALA,2BAKA;AACA;AACA;AACA;;AAEA;AACA,6CADA;AAEA,4BAFA;AAGA,qCAHA;AAIA,yBAJA;AAKA;AALA;;AAQA;;AAEA;AACA,SArBA;;AAsBA;AACA,2BAvBA,iCAuBA;AAAA;;AACA;AACA;AACA,aAFA,EAEA,EAFA;AAGA,SA3BA;AA4BA,2BA5BA,iCA4BA;AAAA;;AACA,YAAY,gDAAZ;AACA;AACA,aAFA,EAEA,KAFA,CAEA;AACA;AACA,aAJA;AAKA,SAlCA;AAmCA,qBAnCA,2BAmCA;AACA;AACA;AACA;AACA,aAFA;AAGA,SAxCA;AAyCA,cAzCA,kBAyCA,OAzCA,EAyCA;AACA;AACA;AA3CA,KAvDA;AAoGA;AACA;AADA,KApGA;AAuGA;AACA;AADA,KAvGA;AA0GA;AACA,YADA,kBACA;AACA;AACA;AAHA;AA1GA,G;;ACvCA,0BAA0B,aAAa,0BAA0B,wBAAwB,iBAAiB,mBAAmB,iBAAiB,OAAO,sCAAsC,wBAAwB,4DAA4D,YAAY,kBAAkB,0CAA0C,kBAAkB,mBAAmB,mFAAmF,2BAA2B,yBAAyB,OAAO,oBAAoB,oCAAoC,iBAAiB,0EAA0E,kBAAkB,OAAO,aAAa,YAAY,OAAO,mCAAmC,KAAK,qBAAqB,0BAA0B,8BAA8B,UAAU,sBAAsB,uCAAuC,QAAQ,8BAA8B,oCAAoC,aAAa,wCAAwC,qBAAqB,EAAE,KAAK,4BAA4B,cAAc,wBAAwB,cAAc,aAAa,wEAAwE,SAAS,cAAc,WAAW,sBAAsB,KAAK,yBAAyB,4BAA4B,QAAQ,EAAE,kCAAkC,gCAAgC,4BAA4B,yBAAyB,KAAK,2BAA2B;AACr+C;AACA,iBAAiB;AACF,0D;;ACHf;AACA,EAAE,mBAAO,CAAC,MAAyZ;AACna;AACA,yBAAyB,mBAAO,CAAC,MAA+D;AAChG;AAC8G;AACa;AAC3H;AACoX;AACpX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,IAAc;AAChB,EAAE,YAAgB;AAClB;AACA;AACA;AACA;AACA;;AAEe,yGAAiB;;;;;;;;AC1BhC,yC","file":"static/js/27.js","sourcesContent":["<template>\n    <div class=\"chat\">\n        <navigate title=\"广东航道\" position=\"absolute\"/>\n        <div class=\"message-list-wrapper\" ref=\"MessageListWrapper\">\n            <div ref=\"MessageList\">\n                <template v-for=\"list in messageList\">\n                    <div class=\"time\">{{list[0].createTime | formatPast}}</div>\n                    <div class=\"message-list\">\n                        <transition-group name=\"fade-chat\">\n                            <div class=\"item\" :class=\"item.self ? 'item-right' : 'item-left'\"\n                                 v-for=\"(item, index) in list\" :key=\"index\">\n                                <mu-avatar size=\"45\">\n                                    <img :src=\"item.avatar\" @error=\"onError\" :alt=\"item.title\">\n                                </mu-avatar>\n                                <div class=\"content-wrapper\">\n                                    <p class=\"content\">{{item.content}}</p>\n                                </div>\n                            </div>\n                        </transition-group>\n                    </div>\n                </template>\n            </div>\n        </div>\n        <div class=\"message-input-wrapper\">\n            <form action=\"javascrpt:;\" class=\"message-input-form\" @submit=\"handlerSubmit\">\n                <label class=\"input-box\">\n                    <input type=\"text\" v-model=\"message\">\n                </label>\n                <mu-button class=\"submit\" color=\"#fff\" flat @click=\"handlerSubmit\">发送</mu-button>\n            </form>\n        </div>\n    </div>\n</template>\n\n<script>\n    import Navigate from '../../../base/navigate/navigate'\n    import FormatTime from '../../../common/utils/time'\n    import {queryIMessageDetail} from \"../../../api/personal\"\n\n    export default {\n        name: \"chat\",\n        data() {\n            return {\n                message: '',\n                defaultAvatar: 'static/image/bg.png',\n                list: [],\n                timer: null,\n                queryParam: {\n                    userId: null,\n                    receiverId: null,\n                    pageSize: 10,\n                    pageNumber: 0\n                },\n                webSocket: null\n            }\n        },\n        props: {\n            id: {\n                type: String,\n                default: ''\n            }\n        },\n        computed: {\n            messageList() {\n                if (this.list.length === 0) {\n                    return\n                }\n                const list = [[this.list[0]]]\n                let index = 0\n                for (let i = 0; i < this.list.length - 1; i++) {\n                    // if (this.list[i].createTime - this.list[i + 1].createTime < 2 * 60 * 1000) {\n                    list[index].push(this.list[i + 1])\n                    // } else {\n                    //     index++\n                    //     list[index].push(this.list[i + 1])\n                    // }\n                }\n\n                return list.reverse()\n            }\n        },\n        created() {\n            this.queryParam.userId = this.$route.query.userId\n            this.queryParam.receiverId = this.$route.query.receiverId\n            this.queryIMessageDetail()\n            // this.initWebsocket()\n            console.log(`%c—————— request ${this.id} message ——————`, 'color: #009688')\n        },\n        mounted() {\n            this.handlerScrollHeight()\n        },\n        beforeDestroy() {\n            clearInterval(this.timer)\n        },\n        methods: {\n            onError(event) {\n                event.target.setAttribute('data-src', event.target.getAttribute('src'))\n                event.target.setAttribute('src', null)\n            },\n            handlerSubmit() {\n                if (!this.message) {\n                    return this.$toast('请输入内容')\n                }\n\n                this.list.push({\n                    avatar: 'static/image/bg.png',\n                    title: '哈哈哈',\n                    content: this.message,\n                    use: true,\n                    time: Date.now()\n                })\n\n                // this.doSend(this.message)\n\n                this.message = ''\n            },\n            // 列表再最后\n            handlerScrollHeight() {\n                setTimeout(time => {\n                    this.$refs.MessageListWrapper.scrollTo(0, this.$refs.MessageList.offsetHeight)\n                }, 60)\n            },\n            queryIMessageDetail() {\n                queryIMessageDetail(this.queryParam).then(res => {\n                    this.list = res\n                }).catch(error => {\n                    console.log(error)\n                })\n            },\n            initWebsocket() {\n                this.websocket = new WebSocket('ws://localhost:8080/websocket?user=1');\n                this.websocket.onmessage = evt => {\n                    console.log(evt.data)\n                }\n            },\n            doSend(message) {\n                this.websocket.send(\"hello\")\n            }\n        },\n        filters: {\n            formatPast: FormatTime.formatPast\n        },\n        components: {\n            Navigate\n        },\n        watch: {\n            list() {\n                this.handlerScrollHeight()\n            }\n        }\n    }\n</script>\n\n<style lang=\"stylus\" scoped>\n    @import \"../../../common/stylus/variable.styl\"\n\n    .chat\n        position absolute\n        top 0\n        right 0\n        left 0\n        bottom 0\n        z-index 1000\n        padding 46px 0 50px\n        background-color #EFEFEF\n        overflow hidden\n        .message-list-wrapper\n            width 100%\n            height 100%\n            overflow-x hidden\n            overflow-y auto\n            .time\n                margin 10px 0\n                color #B2B2B2\n                text-align center\n                font-size $font-size-ms\n            .message-list .item\n                display flex\n                padding 0 12px\n                margin-bottom 15px\n                .content-wrapper\n                    flex 1\n                    .content\n                        position relative\n                        display inline-block\n                        padding 10px 15px\n                        min-height 44px\n                        line-height 1.5625\n                        font-size $font-size-ml\n                        text-align justify\n                        color #696969\n                        background-color #fff\n                        border-radius 5px\n                &.item-left\n                    transform-origin left bottom\n                    .content-wrapper\n                        padding 0 23px 0 10px\n                        text-align left\n                        &:before\n                            content ''\n                            display block\n                            position absolute\n                            top 17.5px\n                            left -10px\n                            width 0\n                            height 0\n                            border 5px solid transparent\n                            border-right-color #fff\n                &.item-right\n                    flex-direction row-reverse\n                    transform-origin right bottom\n                    .content-wrapper\n                        padding 0 10px 0 23px\n                        text-align right\n                        .content:before\n                            content ''\n                            display block\n                            position absolute\n                            top 17.5px\n                            right -10px\n                            width 0\n                            height 0\n                            border 5px solid transparent\n                            border-left-color #fff\n        .message-input-wrapper\n            position fixed\n            bottom 0\n            left 0\n            right 0\n            .message-input-form\n                display flex\n                align-items center\n                height 50px\n                padding 0 15px\n                background-color #FAFAFA\n                .input-box\n                    flex 1\n                    margin-right 10px\n                    > input\n                        width 100%\n                        height 32px\n                        line-height 32px\n                        border 1px solid #EEEEEE\n                        outline none\n                        text-indent .5em\n                .submit\n                    min-width 60px\n                    height 30px\n                    line-height 30px\n                    background-color #3899D7\n                    >>> .mu-button-wrapper\n                        padding 0\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/views/about/message/chat.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"chat\"},[_c('navigate',{attrs:{\"title\":\"广东航道\",\"position\":\"absolute\"}}),_vm._v(\" \"),_c('div',{ref:\"MessageListWrapper\",staticClass:\"message-list-wrapper\"},[_c('div',{ref:\"MessageList\"},[_vm._l((_vm.messageList),function(list){return [_c('div',{staticClass:\"time\"},[_vm._v(_vm._s(_vm._f(\"formatPast\")(list[0].createTime)))]),_vm._v(\" \"),_c('div',{staticClass:\"message-list\"},[_c('transition-group',{attrs:{\"name\":\"fade-chat\"}},_vm._l((list),function(item,index){return _c('div',{key:index,staticClass:\"item\",class:item.self ? 'item-right' : 'item-left'},[_c('mu-avatar',{attrs:{\"size\":\"45\"}},[_c('img',{attrs:{\"src\":item.avatar,\"alt\":item.title},on:{\"error\":_vm.onError}})]),_vm._v(\" \"),_c('div',{staticClass:\"content-wrapper\"},[_c('p',{staticClass:\"content\"},[_vm._v(_vm._s(item.content))])])],1)}))],1)]})],2)]),_vm._v(\" \"),_c('div',{staticClass:\"message-input-wrapper\"},[_c('form',{staticClass:\"message-input-form\",attrs:{\"action\":\"javascrpt:;\"},on:{\"submit\":_vm.handlerSubmit}},[_c('label',{staticClass:\"input-box\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.message),expression:\"message\"}],attrs:{\"type\":\"text\"},domProps:{\"value\":(_vm.message)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.message=$event.target.value}}})]),_vm._v(\" \"),_c('mu-button',{staticClass:\"submit\",attrs:{\"color\":\"#fff\",\"flat\":\"\"},on:{\"click\":_vm.handlerSubmit}},[_vm._v(\"发送\")])],1)])],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-900c0cba\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/about/message/chat.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-900c0cba\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./chat.vue\")\n}\nvar normalizeComponent = require(\"!../../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./chat.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./chat.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-900c0cba\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../node_modules/vue-loader/lib/selector?type=template&index=0!./chat.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-900c0cba\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/about/message/chat.vue\n// module id = null\n// module chunks = ","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/extract-text-webpack-plugin/dist/loader.js?{\"omit\":1,\"remove\":true}!./node_modules/vue-style-loader!./node_modules/css-loader?{\"sourceMap\":true}!./node_modules/vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-900c0cba\",\"scoped\":true,\"hasInlineConfig\":false}!./node_modules/stylus-loader?{\"sourceMap\":true}!./node_modules/vue-loader/lib/selector.js?type=styles&index=0!./src/views/about/message/chat.vue\n// module id = gYbk\n// module chunks = 27"],"sourceRoot":""}