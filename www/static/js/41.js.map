{"version":3,"sources":["webpack:///./src/views/about/setter/update.vue?3fdc","webpack:///src/views/about/setter/update.vue","webpack:///./src/views/about/setter/update.vue?8d85","webpack:///./src/views/about/setter/update.vue"],"names":[],"mappings":";;;;;AAAA,yC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACkDA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,kBADA;AAEA,yCAFA;AAGA,QAHA,kBAGA;AACA;AACA,0BADA;AAEA,mBAFA;AAGA;AACA,8BADA;AAEA,gCAFA;AAGA;AACA,2BADA;AAEA,2BAFA;AAGA;AAHA,iBAHA;AAQA,8BARA;AASA;AATA,aAHA;AAcA;AACA,8BADA;AAEA,wBAFA;AAGA;AAHA;AAdA;AAoBA,KAxBA;AAyBA,aAzBA,uBAyBA;AACA;AACA;;AAEA;AACA,KA9BA;;AA+BA;AACA,mBADA,yBACA;AAAA;;AACA;AACA;AACA,kCADA;AAEA,+BAFA;AAGA,kCAHA;AAIA;AAJA;;AAOA,YAAY,mCAAZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBARA,MAQA;AACA;AACA;;AAEA;AACA;AACA,aAfA;AAgBA,SA1BA;AA2BA,mBA3BA,yBA2BA;AAAA;;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA,YAAY,yCAAZ;AACA;;AAEA;AACA;AACA;AACA;;AAEA,oBAAoB,2CAApB;AACA;;AAEA;AACA;AACA;AACA;AACA,aAfA,EAeA,WAfA;AAgBA;AAtDA,KA/BA;AAuFA;AACA,8CADA;AAEA;AAFA;AAvFA,G;;AC1DA,0BAA0B,aAAa,0BAA0B,wBAAwB,iBAAiB,qBAAqB,iBAAiB,OAAO,oCAAoC,wBAAwB,6BAA6B,YAAY,wBAAwB,YAAY,iDAAiD,gBAAgB,OAAO,mDAAmD,4BAA4B,aAAa,4EAA4E,sDAAsD,6BAA6B,mEAAmE,sBAAsB,oGAAoG,0BAA0B,YAAY,kCAAkC,aAAa,oBAAoB,0CAA0C,kBAAkB,kBAAkB,gCAAgC,qBAAqB,KAAK,yBAAyB,2BAA2B,6CAA6C,iCAAiC,uCAAuC,KAAK,yBAAyB,mFAAmF,kBAAkB,gEAAgE,kBAAkB,sEAAsE,kBAAkB,qEAAqE,kBAAkB,2FAA2F,gBAAgB,wBAAwB,yBAAyB,iEAAiE,6BAA6B,kBAAkB,6CAA6C,yBAAyB,KAAK,yBAAyB,4DAA4D,OAAO,2DAA2D,KAAK,+BAA+B,4CAA4C,4FAA4F,OAAO,sDAAsD;AACrxE;AACA,iBAAiB;AACF,2D;;ACHf;AACA,EAAE,mBAAO,CAAC,MAA2Z;AACra;AACA,yBAAyB,mBAAO,CAAC,MAA+D;AAChG;AACgH;AACa;AAC7H;AACsX;AACtX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,MAAc;AAChB,EAAE,aAAgB;AAClB;AACA;AACA;AACA;AACA;;AAEe,0GAAiB","file":"static/js/41.js","sourcesContent":["// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/extract-text-webpack-plugin/dist/loader.js?{\"omit\":1,\"remove\":true}!./node_modules/vue-style-loader!./node_modules/css-loader?{\"sourceMap\":true}!./node_modules/vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-5f212996\",\"scoped\":true,\"hasInlineConfig\":false}!./node_modules/stylus-loader?{\"sourceMap\":true}!./node_modules/vue-loader/lib/selector.js?type=styles&index=0!./src/views/about/setter/update.vue\n// module id = 5Ksj\n// module chunks = 41","<template>\r\n    <div class=\"update\">\r\n        <navigate title=\"更新\" position=\"absolute\"/>\r\n        <div class=\"scroll-wrapper\">\r\n            <div class=\"box paper\">\r\n                <div class=\"news-icon-wrapper mu-primary-color\">\r\n                    <mu-icon value=\"arrow_upward\" size=\"70\" color=\"#fff\"></mu-icon>\r\n                </div>\r\n                <div class=\"por version-status pt-15 pb-10\"\r\n                     data-mu-loading-size=\"16\"\r\n                     v-loading=\"loading\">{{tip}}\r\n                </div>\r\n                <div class=\"version\">{{version}}</div>\r\n                <mu-expand-transition>\r\n                    <div class=\"new-version\" v-if=\"news.visible\">\r\n                        <div class=\"header border-1px-b\">\r\n                            <span class=\"title\">发现新版本</span>\r\n                            <div class=\"btn\">\r\n                                <mu-button class=\"ignore-btn\" @click=\"news.visible = false\" flat small>忽略</mu-button>\r\n                                <mu-button class=\"version-btn\" color=\"success\" @click=\"downloadApk\" flat small>升级\r\n                                </mu-button>\r\n                            </div>\r\n                        </div>\r\n                        <ul>\r\n                            <li class=\"lhp\">版本：{{news.version}}</li>\r\n                            <li class=\"lhp\">大小：{{news.file.size}}M</li>\r\n                            <li class=\"lhp\">更新时间：{{news.uploadTime}}</li>\r\n                            <li class=\"lhp\">更新内容：</li>\r\n                            <li class=\"pl-25 lht\" v-for=\"item in news.uploadContent.split(/\\n/)\">{{item}}</li>\r\n                        </ul>\r\n                    </div>\r\n                </mu-expand-transition>\r\n            </div>\r\n            <div class=\"button-wrapper\" v-if=\"!news.visible\">\r\n                <mu-button class=\"button mu-primary-color\" color=\"#fff\" @click=\"checkUpdate\" flat>检查更新</mu-button>\r\n            </div>\r\n\r\n            <!-- dialog -->\r\n            <mu-dialog :open.sync=\"progress.visible\" width=\"80%\" lock-scroll>\r\n                <mu-sub-header>正在下载...</mu-sub-header>\r\n                <br/>\r\n                <m-progress :progress=\"progress.value\" :max=\"progress.max\"/>\r\n                <br/>\r\n            </mu-dialog>\r\n            <!-- dialog -->\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import Navigate from \"../../../base/navigate/navigate\"\r\n    import MProgress from \"../../../base/progress/progress\"\r\n    import {appMixins} from \"../../../common/mixins\"\r\n    import {checkUpdate} from \"../../../api/sys\"\r\n    import {installationApkfile} from \"../../../common/js/cordova/map\"\r\n    import {downloadFile, getSavePath} from \"../../../common/js/cordova/download\"\r\n    import {versionContrast} from \"../../../types\"\r\n\r\n    export default {\r\n        name: \"update\",\r\n        mixins: [appMixins],\r\n        data() {\r\n            return {\r\n                loading: false,\r\n                tip: '',\r\n                news: {\r\n                    visible: false,\r\n                    version: '0.0.0',\r\n                    file: {\r\n                        size: 0,\r\n                        url: '',\r\n                        savePath: ''\r\n                    },\r\n                    uploadTime: '',\r\n                    uploadContent: '',\r\n                },\r\n                progress: {\r\n                    visible: false,\r\n                    value: 0,\r\n                    max: 100\r\n                }\r\n            }\r\n        },\r\n        activated() {\r\n            this.loading = false\r\n            this.tip = ''\r\n\r\n            this.checkUpdate()\r\n        },\r\n        methods: {\r\n            checkUpdate() {\r\n                this.loading = true\r\n                this.$toast({\r\n                    position: 'center',\r\n                    type: 'loading',\r\n                    message: '正在查询 ……',\r\n                    duration: 0\r\n                })\r\n\r\n                checkUpdate(this.version).then(res => {\r\n                    if (res && res.version && versionContrast(this.version, res.version)) {\r\n                        this.news.visible = true\r\n                        this.news.version = res.version\r\n                        this.news.file.size = (res.file_size / 1024 / 1024).toFixed(2)\r\n                        this.news.file.url = res.file_url\r\n                        this.news.uploadTime = res.upload_time\r\n                        this.news.uploadContent = res.detail\r\n                        this.tip = '发现新版本'\r\n                    } else {\r\n                        this.tip = '已经是最新版本'\r\n                    }\r\n\r\n                    this.loading = false\r\n                    this.$toast.clear()\r\n                })\r\n            },\r\n            downloadApk() {\r\n                this.progress.visible = true\r\n                // this.news.file.url = this.$images + this.news.file.url\r\n                if (!this.news.file.url) {\r\n                    return this.$toast('无效下载地址')\r\n                }\r\n\r\n                console.log(`%c新版本下载地址: ${this.news.file.url}`, 'color: #9c27b0')\r\n\r\n                this.news.file.savePath = getSavePath() + this.version + \".apk\"\r\n\r\n                downloadFile(this.news.file.url, this.news.file.savePath, success => {\r\n                    let data = JSON.parse(success.toString())\r\n\r\n                    //下载完成安装apk\r\n                    if (data.type === \"completed\") {\r\n                        this.progress.visible = false\r\n                        this.news.visible = false\r\n\r\n                        installationApkfile(this.news.file.savePath)\r\n                    }\r\n\r\n                    if (data.type === \"progress\") {\r\n                        this.progress.value = Number.parseInt(data.soFarBytes)\r\n                        this.progress.max = Number.parseInt(data.totalBytes)\r\n                    }\r\n                }, console.log)\r\n            }\r\n        },\r\n        components: {\r\n            MProgress,\r\n            Navigate\r\n        }\r\n    }\r\n</script>\r\n\r\n<style lang=\"stylus\" scoped>\r\n    @import \"../../../common/stylus/variable.styl\"\r\n\r\n    .update\r\n        padding-top 46px\r\n\r\n        .scroll-wrapper\r\n            width 100%\r\n            height 100%\r\n\r\n            .box\r\n                display flex\r\n                flex-direction column\r\n                align-items center\r\n                justify-content center\r\n                margin-top 8px\r\n                padding 20px 0\r\n\r\n                .version-status\r\n                    display block\r\n                    min-width 30px\r\n                    height $font-size-ml + 25px\r\n                    font-size $font-size-ml\r\n                    text-align center\r\n\r\n                .version\r\n                    font-size $font-size-ms\r\n                    opacity 0.7\r\n\r\n            .new-version\r\n                padding 0 20px\r\n                width 100%\r\n\r\n                .header\r\n                    line-height 48px\r\n                    margin-bottom: 10px;\r\n\r\n                    .title\r\n                        font-size $font-size-ls\r\n\r\n                    .btn\r\n                        float right\r\n\r\n                        .mu-flat-button\r\n                            min-width 40px\r\n                            border-radius: 4px;\r\n\r\n                            &.ignore-btn\r\n                                color #9C9C9C;\r\n\r\n                            &.version-btn\r\n                                border: 1px solid #4caf50;\r\n\r\n                ul li\r\n                    font-size $font-size-ms\r\n                    line-height 1.74625\r\n                    opacity 0.7\r\n\r\n            .button-wrapper\r\n                padding 15px\r\n\r\n                .button\r\n                    width 100%\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/views/about/setter/update.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"update\"},[_c('navigate',{attrs:{\"title\":\"更新\",\"position\":\"absolute\"}}),_vm._v(\" \"),_c('div',{staticClass:\"scroll-wrapper\"},[_c('div',{staticClass:\"box paper\"},[_c('div',{staticClass:\"news-icon-wrapper mu-primary-color\"},[_c('mu-icon',{attrs:{\"value\":\"arrow_upward\",\"size\":\"70\",\"color\":\"#fff\"}})],1),_vm._v(\" \"),_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}],staticClass:\"por version-status pt-15 pb-10\",attrs:{\"data-mu-loading-size\":\"16\"}},[_vm._v(_vm._s(_vm.tip)+\"\\n            \")]),_vm._v(\" \"),_c('div',{staticClass:\"version\"},[_vm._v(_vm._s(_vm.version))]),_vm._v(\" \"),_c('mu-expand-transition',[(_vm.news.visible)?_c('div',{staticClass:\"new-version\"},[_c('div',{staticClass:\"header border-1px-b\"},[_c('span',{staticClass:\"title\"},[_vm._v(\"发现新版本\")]),_vm._v(\" \"),_c('div',{staticClass:\"btn\"},[_c('mu-button',{staticClass:\"ignore-btn\",attrs:{\"flat\":\"\",\"small\":\"\"},on:{\"click\":function($event){_vm.news.visible = false}}},[_vm._v(\"忽略\")]),_vm._v(\" \"),_c('mu-button',{staticClass:\"version-btn\",attrs:{\"color\":\"success\",\"flat\":\"\",\"small\":\"\"},on:{\"click\":_vm.downloadApk}},[_vm._v(\"升级\\n                            \")])],1)]),_vm._v(\" \"),_c('ul',[_c('li',{staticClass:\"lhp\"},[_vm._v(\"版本：\"+_vm._s(_vm.news.version))]),_vm._v(\" \"),_c('li',{staticClass:\"lhp\"},[_vm._v(\"大小：\"+_vm._s(_vm.news.file.size)+\"M\")]),_vm._v(\" \"),_c('li',{staticClass:\"lhp\"},[_vm._v(\"更新时间：\"+_vm._s(_vm.news.uploadTime))]),_vm._v(\" \"),_c('li',{staticClass:\"lhp\"},[_vm._v(\"更新内容：\")]),_vm._v(\" \"),_vm._l((_vm.news.uploadContent.split(/\\n/)),function(item){return _c('li',{staticClass:\"pl-25 lht\"},[_vm._v(_vm._s(item))])})],2)]):_vm._e()])],1),_vm._v(\" \"),(!_vm.news.visible)?_c('div',{staticClass:\"button-wrapper\"},[_c('mu-button',{staticClass:\"button mu-primary-color\",attrs:{\"color\":\"#fff\",\"flat\":\"\"},on:{\"click\":_vm.checkUpdate}},[_vm._v(\"检查更新\")])],1):_vm._e(),_vm._v(\" \"),_c('mu-dialog',{attrs:{\"open\":_vm.progress.visible,\"width\":\"80%\",\"lock-scroll\":\"\"},on:{\"update:open\":function($event){_vm.$set(_vm.progress, \"visible\", $event)}}},[_c('mu-sub-header',[_vm._v(\"正在下载...\")]),_vm._v(\" \"),_c('br'),_vm._v(\" \"),_c('m-progress',{attrs:{\"progress\":_vm.progress.value,\"max\":_vm.progress.max}}),_vm._v(\" \"),_c('br')],1)],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-5f212996\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/about/setter/update.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-5f212996\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./update.vue\")\n}\nvar normalizeComponent = require(\"!../../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./update.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./update.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-5f212996\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../node_modules/vue-loader/lib/selector?type=template&index=0!./update.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-5f212996\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/about/setter/update.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}